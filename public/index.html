<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YTmusic - Play youtube audionly</title>
    <script>
      rewireLoggingToElement(
    () => document.getElementById("log"),
    () => document.getElementById("log-container"), true);

function rewireLoggingToElement(eleLocator, eleOverflowLocator, autoScroll) {
    fixLoggingFunc('log');
    fixLoggingFunc('debug');
    fixLoggingFunc('warn');
    fixLoggingFunc('error');
    fixLoggingFunc('info');

    function fixLoggingFunc(name) {
        console['old' + name] = console[name];
        console[name] = function(...arguments) {
            const output = produceOutput(name, arguments);
            const eleLog = eleLocator();

            if (autoScroll) {
                const eleContainerLog = eleOverflowLocator();
                const isScrolledToBottom = eleContainerLog.scrollHeight - eleContainerLog.clientHeight <= eleContainerLog.scrollTop + 1;
                eleLog.innerHTML += output + "<br>";
                if (isScrolledToBottom) {
                    eleContainerLog.scrollTop = eleContainerLog.scrollHeight - eleContainerLog.clientHeight;
                }
            } else {
                eleLog.innerHTML += output + "<br>";
            }

            console['old' + name].apply(undefined, arguments);
        };
    }

    function produceOutput(name, args) {
        return args.reduce((output, arg) => {
            return output +
                "<span class=\"log-" + (typeof arg) + " log-" + name + "\">" +
                    (typeof arg === "object" && (JSON || {}).stringify ? JSON.stringify(arg) : arg) +
                "</span>&nbsp;";
        }, '');
    }
}

    </script>
    <script type="text/javascript" src="/js/W3Module.js"></script>
    <script type="text/javascript" src="/js/schema-ebml.js"></script>
    <script type="text/javascript" src="/js/lib-ebml.js"></script>
    <style>
      #log-container { overflow: auto; height: 150px; }
      .log-warn { color: orange }
      .log-error { color: red }
      .log-info { color: skyblue }
      .log-log { color: silver }
      .log-warn, .log-error { font-weight: bold; }
    </style>
  </head>
  <body>
    <audio id="videoAudio" controls>
    </audio>
    <div id="log-container">
      <pre id="log"></pre>
    </div>
    <script>
      W3Module.getWebmBlob('/stream/p5MY9CY5MOk').then( (webmBlob) => {
        W3Module.convertWebmToMP3(webmBlob).then( (mp3Blob) => {
            document.querySelector("#videoAudio").src = window.URL.createObjectURL(mp3Blob);
            document.querySelector("#videoAudio").play();
        });
      });
      
      /*
      const thumbnail = videoInfo.thumbnail.split("?")[0];
      document.querySelector("#videoThumbnail").src = thumbnail;
      document.querySelector("#videoAudio").src = videoInfo.url;
      document.querySelector("#videoTitle").textContent = videoInfo.title;
      document.querySelector("#videoAuthor").textContent = videoInfo.author;
      */
    </script>
  </body>
</html>
